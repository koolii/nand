# Hackハードウェアのプラットフォーム仕様

## 概要
### 構成
* 16ビットのノイマン型コンピュータ
* CPUが1つ
* メモリモジュールが2つ(命令メモリ・データメモリ)
* メモリマップドI/Oが2つ(スクリーンとキーボード)

命令メモリ(ROM)、データメモリ(RAM)
* Hackコンピュータは命令メモリに存在するプログラムを実行する
* ROMは読み込み専用なので、別方法でロードしなければならない(必要とするプログラムはROMがすでに読み込まれた状態で使用する)
* そのために **Hackの機械語で書かれたプログラムを含むテキストファイルをROMに読み込む操作が可能**
* HackのCPUは、ALUとデータレジスタ（D)、アドレスレジスタ（A)、プログラムカウンタ（PC)で構成される
* Aレジスタは、データ値、RAMアドレス、ROMアドレスの3つの命令を実施できる
* Hack機械語は2種類の16ビット命令をベースとしている
  * アドレス命令 「0xxxxxxxxxxxxxxx」というフォーマット
  * 計算命令 「111acccccdddjjj」というフォーマット
  * a/cビットはALUに行う関数を指示
  * dビットはALUの出力を格納する場所を指定
  * jビットはオプションで、移動条件を指定
  * PCの出力はROM回路のアドレス入力に接続されてるの、ROM[PC]で命令メモリ中でPCが指す場所のデータ値が取得=>現在命令

コンピュータ全体の操作
#### 実行
現在命令は様々な回路へ送られる
それがアドレス命令(一番左のビットが0)なら、命令メモリの15ビットの定数値がAレジスタに設定
それが計算命令（一番左のビットが1）ならa,c,d,jビットは制御ビットとなり、ALUとレジスタに命令を実行

#### フェッチ
次にどの命令をフェッチするかは「現在命令のjビット(jump)」と「ALUの出力」で決定する
ジャンプするならPCにAレジスタの値を設定
それ以外はPCの値は1だけインクリメントされる

次のクロック周期でPCの命令がROMの出力から送信される

**メモリアクセスを伴う操作は通常ふたつの命令を使う、1つはアドレス命令でAレジスタに特定のアドレスを設定  もう1つは計算命令でAレジスタ内のアドレスに何らかの操作(RAMへの読み書き命令、ROMへの移動命令)を行う**
